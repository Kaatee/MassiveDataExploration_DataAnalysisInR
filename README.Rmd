---
title: "Eksploracja Masywnych Danych - projekt 1 - Analiza danych"
author: "Katarzyna Jóźwiak 127237, Piotr Pawlaczyk 127245"
output:
  md_document: 
   toc: true
   #theme: united
---
data wygenerowania: '`r format(Sys.Date(), "%Y-%B-%d")`'

# Podsumowanie badań
//TODO podsumowanie calego raportu

# Wykorzystane biblioteki
//TODO Kod wyliczający wykorzystane biblioteki.
library(datasets)
library(corrplot)

# Zapewnienie powtarzalności wyników przy każdym uruchomieniu raportu na tych samych danych
```{r}
set.seed(23)
```

# Wczytywanie danych z pliku
```{r}
names <- read.table("sledzie.csv", nrow=1, stringsAsFactors = FALSE, sep = ",")
data <- read.table("sledzie.csv", header=TRUE,, stringsAsFactors = FALSE, sep=",")
head(data)

sapply(data, class)
```
Zmiana "?" na "NA" wraz ze zmianą typu danych z character na numeric:
```{r}
data[data=="?"] <- NA

data$cfin1 <- as.numeric(data$cfin1)
data$cfin2 <- as.numeric(data$cfin2)
data$chel1 <- as.numeric(data$chel1)
data$chel2 <- as.numeric(data$chel2)
data$lcop1 <- as.numeric(data$lcop1)
data$lcop2 <- as.numeric(data$lcop2)
data$sst <- as.numeric(data$sst)

head(data)
sapply(data, class)

```

# Rozmiar zbioru i statystyki
Sekcja podsumowująca rozmiar zbioru i podstawowe statystyki.
```{r}
paste("Wczytane dane zawierają ", nrow(data), " rekordów oraz ", ncol(data), " kolumn.", sep=" ")
```

Podsumowanie wartości danych:
```{r}
summary(data)
```

Ilość brakujących danych dla poszczególnych kolumn:
```{r}
missingData <- sapply(data, function(x) sum(is.na(x)))
missingData
class(missingData)
```
Wykres ilości brakujących danych w zbiorze:

```{r}
knitr::opts_chunk$set(fig.width=12, fig.height=8) 
plot(x = factor(names(missingData)), y = missingData, main="Wykres ilości brakujących danych w zbiorze", xlab="atrybut", ylab = "ilość brakujących artybutów")
```


# Brakujące dane
//TODO Kod przetwarzający brakujące dane.

# Szczegółowa analiza zbiorów wartości
//TODO Szczegółowa analiza wartości atrybutów (np. poprzez prezentację rozkładów wartości).


# Korelacja między zmiennymi
//TODO Sekcja sprawdzająca korelacje między zmiennymi; sekcja ta powinna zawierać jakąś formę graficznej prezentacji korelacji.
```{r cache=TRUE}
plot(data[,c(1:4)])
plot(data[,c(5:8)])
plot(data[,c(9:12)])
plot(data[,c(13:16)])
```

```{r}
res <- cor(na.omit(data)) #TODO - ogarnac brakujace wartosci w danych 
round(res, 2)

library(corrplot)
corrplot(res, type = "upper", tl.col = "black", tl.srt = 45)
```



# Zmiana rozmiaru śledzia w czasie
//TODO Interaktywny wykres lub animację prezentującą zmianę rozmiaru śledzi w czasie.

# Przewidywanie rozmiaru śledzia
//TODO Sekcję próbującą stworzyć regresor przewidujący rozmiar śledzia (w tej sekcji należy wykorzystać wiedzę z pozostałych punktów oraz wykonać dodatkowe czynności, które mogą poprawić trafność predykcji); dobór parametrów modelu oraz oszacowanie jego skuteczności powinny zostać wykonane za pomocą techniki podziału zbioru na dane uczące, walidujące i testowe; trafność regresji powinna zostać oszacowana na podstawie miar R2 i RMSE.

# Analiza ważnośći atrybutów najlepszego znalezionego modelu regresji
//TODO Analiza ważności atrybutów najlepszego znalezionego modelu regresji. Analiza ważności atrybutów powinna stanowić próbę odpowiedzi na pytanie: co sprawia, że rozmiar śledzi zaczął w pewnym momencie maleć.
